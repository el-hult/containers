Bootstrap: docker
From: nvcr.io/nvidia/jax:23.08-py3

%files
    test_jax.py
    test_pymc.py
    test_numpyro.py
    test_pyvista.py

%post
    export DEBIAN_FRONTEND=noninteractive
    apt-get update && \
    apt-get install -y xvfb libgl1-mesa-dev

    pip install --upgrade pip && \
    pip install --no-cache-dir \
        polars pandas openpyxl pyarrow \
        seaborn matplotlib imageio \
        pymc numpyro[cuda] bambi \
        tqdm \
        ipython scipy \
        relplot numpy

%test
    python /test_pyvista.py
    python /test_jax.py
    python /test_pymc.py
    python /test_numpyro.py